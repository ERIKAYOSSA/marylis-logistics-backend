<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="/static/logo ML.png">
  <title>Register - Marylis Logistics</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --bg-light: #ffffff;
      --text-light: #212529;
      --bg-dark: #121212;
      --text-dark: #f1f1f1;
      --header-light: #ffffff;
      --header-dark: #1f1f1f;
    }

    body {
      background-color: var(--bg-light);
      color: var(--text-light);
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .dark-mode {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    .navbar, footer {
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    .navbar {
      background-color: var(--header-light);
      color: var(--text-light);
    }

    .dark-mode .navbar {
      background-color: var(--header-dark);
      color: var(--text-dark);
    }

    .dark-mode .navbar .form-select,
    .dark-mode .navbar .btn {
      background-color: #2a2a2a;
      color: var(--text-dark);
      border-color: #444;
    }

    .register-container {
      max-width: 600px;
      margin: auto;
      padding-top: 60px;
    }

    .form-control {
      border: 1px solid #ccc;
      border-radius: 0.375rem;
      background-color: transparent;
      color: inherit;
    }

    .form-control::placeholder {
      color: #999;
    }

    .legal-box {
      margin-top: 40px;
      font-size: 0.9rem;
      background-color: #f8f9fa;
      padding: 1.5rem;
      border-radius: 0.5rem;
    }

    .dark-mode .legal-box {
      background-color: #2a2a2a;
      color: var(--text-dark);
    }

    footer {
      border-top: 1px solid #ccc;
      padding: 1rem 0;
      background-color: var(--header-light);
      color: var(--text-light);
    }

    .dark-mode footer {
      background-color: var(--header-dark);
      color: var(--text-dark);
    }

    .theme-toggle {
      cursor: pointer;
    }

    #passwordError {
      display: none;
    }
  </style>
</head>
<body>

  <!-- 🔝 Header -->
  <nav class="navbar border-bottom px-4 d-flex justify-content-between align-items-center">
    <img src="/static/logo ML.png" alt="Marylis Logo" style="max-height: 50px;">
    <div class="d-flex align-items-center gap-3">
      <select id="langSelect" class="form-select form-select-sm w-auto">
        <option value="en" selected>English</option>
        <option value="fr">Français</option>
      </select>
      <span id="themeToggle" class="theme-toggle btn btn-sm btn-outline-secondary">🌗</span>
    </div>
  </nav>

  <!-- 📝 Register Form -->
  <div class="register-container">
    <h2 class="text-center mb-4">Create Your Marylis Logistics Account</h2>

    {% if error %}
      <div class="alert alert-danger text-center fw-semibold">
        {{ error }}
      </div>
    {% endif %}

    <form method="post" action="/register" id="registerForm">
      <!-- Champs avec labels et icônes dans les placeholders -->
      <label class="form-label">Create Username</label>
      <input type="text" class="form-control mb-3" name="username" placeholder="👤 Create username" required>

      <label class="form-label">Email Address</label>
      <input type="email" class="form-control mb-3" name="email" placeholder="📧 Enter your email address" required>

      <label class="form-label">First Name</label>
      <input type="text" class="form-control mb-3" name="first_name" placeholder="🧍 First name" required>

      <label class="form-label">Surname</label>
      <input type="text" class="form-control mb-3" name="surname" placeholder="🧍 Surname" required>

      <label class="form-label">Country/Region</label>
      <input type="text" class="form-control mb-3" name="country" placeholder="🌍 Country/Region" required>

      <label class="form-label">Contact Number</label>
      <input type="contact_number" class="form-control mb-3" name="contact_number" placeholder="📞 Contact number" required>

      <label class="form-label">Mobile Number (optional)</label>
      <input type="mobile_number" class="form-control mb-3" name="mobile_number" placeholder="📱 Mobile number">

      <label class="form-label">New Password</label>
      <input type="password" class="form-control mb-3" name="new_password" placeholder="🔒 New password" required>

      <label class="form-label">Confirm New Password</label>
      <input type="password" class="form-control mb-1" name="confirm_password" placeholder="✅ Confirm password" required>
      <div id="passwordError" class="text-danger small">Passwords do not match.</div>

      <!-- Checkboxes -->
      <div class="form-check mt-3">
        <input class="form-check-input" type="checkbox" id="termsCheck" required>
        <label class="form-check-label">
          I accept the registered user terms and cookie policy
        </label>
      </div>

      <div class="form-check mt-2">
        <input class="form-check-input" type="checkbox" id="marketingCheck">
        <label class="form-check-label">
          I agree to receive logistics related news and marketing updates by email, phone, or similar from Marylis Logistics and its affiliated companies. I understand that I can opt out of such Marylis communications at any time. To see how we process your personal data read our Privacy Notification.
        </label>
      </div>

      <!-- Mentions légales -->
      <div class="legal-box mt-4">
        By registering as a new user, you accept without restriction the user terms (encompassing general user terms, registered user terms and privacy notification) and you will be granted access to our online business services. You can book and track your cargo, submit your shipping instructions, get access to transport documents, view your account statement and view or download reports with detailed data of your cargo movements.

        As a registered customer, you can view your personal and company details in your profile. A list of users within your company is also available.

        Without waiving any other rights and remedies, any breach or violation of the user terms is subject to legal prosecution.
      </div>

      <button type="submit" class="btn btn-dark w-100 mt-4" id="submitBtn" disabled>Submit</button>
    </form>
  </div>

  <!-- 🔻 Footer -->
  <footer class="d-flex justify-content-between align-items-center px-4 mt-5">
    <img src="/static/logo ML.png" alt="Marylis Logo" style="max-height: 40px;">
    <div class="d-flex gap-3">
      <a href="#cookies-policy" class="text-decoration-none">Cookies Policy</a>
      <a href="#cookies-preferences" class="text-decoration-none">Cookies Preferences</a>
    </div>
  </footer>

  <!-- ⚙️ Script for theme and validation -->
  <script>
    document.getElementById('themeToggle').addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
    });

    document.getElementById('langSelect').addEventListener('change', function () {
      const lang = this.value;
      window.location.href = lang === 'fr' ? '/fr/register' : '/en/register';
    });

    const form = document.getElementById('registerForm');
    const submitBtn = document.getElementById('submitBtn');
    const requiredFields = form.querySelectorAll('input[required]');
    const termsCheck = document.getElementById('termsCheck');
    const passwordField = form.querySelector('input[name="new_password"]');
    const confirmField = form.querySelector('input[name="confirm_password"]');
    const passwordError = document.getElementById('passwordError');

    function validateForm() {
      let allFilled = true;
      requiredFields.forEach(field => {
        if (!field.value.trim()) {
          allFilled = false;
        }
      });

      const passwordsMatch = passwordField.value === confirmField.value;

      if (!passwordsMatch && confirmField.value !== "") {
        passwordError.style.display = "block";
      } else {
        passwordError.style.display = "none";
      }

      if (allFilled && termsCheck.checked && passwordsMatch) {
        submitBtn.disabled = false;
        submitBtn.classList.remove('btn-dark');
        submitBtn.classList.add('btn-success');
      } else {
        submitBtn.disabled = true;
        submitBtn.classList.remove('btn-success');
        submitBtn.classList.add('btn-dark');
      }
    }

    form.addEventListener('input', validateForm);
    form.addEventListener('change', validateForm);
  </script>
</body>
</html>